<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no">
  <meta name="description" content="API docs for the init method from the NodeService class, for the Dart programming language.">
  <title>init method - NodeService class - node library - Dart API</title>


  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,300;0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
  <link rel="stylesheet" href="../../static-assets/github.css?v1">
  <link rel="stylesheet" href="../../static-assets/styles.css?v1">
  <link rel="icon" href="../../static-assets/favicon.png?v1">

  
</head>


<body data-base-href="../../"
      data-using-base-href="false">

<div id="overlay-under-drawer"></div>

<header id="title">
  <button id="sidenav-left-toggle" type="button">&nbsp;</button>
  <ol class="breadcrumbs gt-separated dark hidden-xs">
    <li><a href="../../index.html">tiki_sdk_dart</a></li>
    <li><a href="../../node/node-library.html">node</a></li>
    <li><a href="../../node/NodeService-class.html">NodeService</a></li>
    <li class="self-crumb">init method</li>
  </ol>
  <div class="self-name">init</div>
  <form class="search navbar-right" role="search">
    <input type="text" id="search-box" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
</header>

<main>


  <div id="dartdoc-main-content" class="main-content">
      <div>
<h1><span class="kind-method">init</span> method 
    <a href="https://dart.dev/null-safety" class="feature feature-null-safety" title="Supports the null safety language feature.">Null safety</a>
</h1></div>

    <section class="multi-line-signature">
      

<span class="returntype">Future<span class="signature">&lt;<wbr><span class="type-parameter"><a href="../../node/NodeService-class.html">NodeService</a></span>&gt;</span></span>
<span class="name ">init</span>(<wbr><ol class="parameter-list"><li><span class="parameter" id="init-param-database"><span class="type-annotation">Database</span> <span class="parameter-name">database</span>, </span></li>
<li><span class="parameter" id="init-param-keysInterface"><span class="type-annotation"><a href="../../node/KeyInterface-class.html">KeyInterface</a></span> <span class="parameter-name">keysInterface</span>, </span></li>
<li><span class="parameter" id="init-param-backupStorage"><span class="type-annotation">BackupStorageInterface</span> <span class="parameter-name">backupStorage</span>, </span></li>
<li><span class="parameter" id="init-param-primary">{<span class="type-annotation">String?</span> <span class="parameter-name">primary</span>, </span></li>
<li><span class="parameter" id="init-param-readOnly"><span class="type-annotation">List<span class="signature">&lt;<wbr><span class="type-parameter">String</span>&gt;</span></span> <span class="parameter-name">readOnly</span> = <span class="default-value">const []</span>, </span></li>
<li><span class="parameter" id="init-param-maxTransactions"><span class="type-annotation">int</span> <span class="parameter-name">maxTransactions</span> = <span class="default-value">200</span>, </span></li>
<li><span class="parameter" id="init-param-blockInterval"><span class="type-annotation">Duration</span> <span class="parameter-name">blockInterval</span> = <span class="default-value">const Duration(minutes: 1)</span>}</span></li>
</ol>)

      

    </section>
    
<section class="desc markdown">
  <p>Initialize the service</p>
<p>All the related chains addresses should be added to <code>addresses</code> list as
<code>base64Url</code> representation of the address.</p>
<p>The first address in the <code>addresses</code> list for which <code>keysInterface</code> has a private
key is the one that will be used for read and write operations.
All the other ones are used in read-only mode, even if <code>keysInterface</code>
has its private key stored.</p>
<p>The <code>apiKey</code> is used for remote backup connection. Please visit mytiki.com
to get yours. If no <code>apiKey</code> is provided or if the key is invalid, the node
will work in local mode only and will be not able to save the chain remotely
nor synchronize with other chains.</p>
<p>The <code>database</code> should be a <code>Database</code> instance, implemented in the host OS
appropriate library. If no <code>database</code> is provided the SDK will use the OS
memory for persistence what could cause inconsistencies. It should only be
used for tests or thin clients with read-only operations. It is NOT RECOMMENDED
for writing to the chain.</p>
<p>The <code>keysInterface</code> should be a <code>KeysInterface</code> implementation
using encrypted key-value storage, specifically for each host OS.
It should not be accessed by other applications or users because it will
store the private keys of the user, which is required for write operations
in the chain.</p>
<p>EncryptedSharedPreferences should be used for Android. AES encryption is
another option with AES secret key encrypted with RSA and RSA key is stored
in KeyStore.</p>
<p>Keychain is recommended for iOS and MacOS.</p>
<p>For Linux libsecret is a reliable option.</p>
<p>In JavaScript web environments the recommendation is WebCrypto with HTST enabled.</p>
<p>In other environments, use equivalent implementations of the recommended ones.</p>
<p>The <code>NodeService</code> uses a internal <code>Timer</code> to build a new <a href="../../block/BlockModel-class.html">BlockModel</a> every
<code>blkInterval</code>. The default value is 1 minute. If there are any <a href="../../transaction/TransactionModel-class.html">TransactionModel</a>
in the <code>database</code> that was not added to a <a href="../../block/BlockModel-class.html">BlockModel</a> yet, it creates a new
<a href="../../block/BlockModel-class.html">BlockModel</a> if the last <a href="../../transaction/TransactionModel-class.html">TransactionModel</a> was created before 1 minute ago
or if the total size of the serialized transactions is greater than 100kb.</p>
</section>


    
<section class="summary source-code" id="source">
  <h2><span>Implementation</span></h2>
  <pre class="language-dart"><code class="language-dart">Future&lt;NodeService&gt; init(Database database, KeyInterface keysInterface,
    BackupStorageInterface backupStorage,
    {String? primary,
    List&lt;String&gt; readOnly = const [],
    int maxTransactions = 200,
    Duration blockInterval = const Duration(minutes: 1)}) async {
  _backupStorage = backupStorage;
  _transactionService = TransactionService(database);
  _blockService = BlockService(database);
  _keyService = KeyService(keysInterface);
  _xchainService = XchainService(database, _backupStorage);
  _blockInterval = blockInterval;
  _maxTransactions = maxTransactions;

  await _loadPrimaryKey(primary);

  _backupService = BackupService(_backupStorage, database, _primaryKey, (id) {
    BlockModel? header = _blockService.get(id);
    if (header == null) return null;

    List&lt;TransactionModel&gt; transactions = _transactionService.getByBlock(id);
    if (transactions.isEmpty) return null;

    return _serializeBlock(header, transactions);
  });

  List&lt;TransactionModel&gt; transactions = _transactionService.getPending();
  if (transactions.isNotEmpty &amp;&amp;
      transactions.last.timestamp
          .isBefore(DateTime.now().subtract(_blockInterval))) {
    await _createBlock(transactions);
  }

  _startBlockTimer();
  return this;
}</code></pre>
</section>


  </div> <!-- /.main-content -->

  <div id="dartdoc-sidebar-left" class="sidebar sidebar-offcanvas-left">
    <header id="header-search-sidebar" class="hidden-l">
  <form class="search-sidebar" role="search">
    <input type="text" id="search-sidebar" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
</header>

<ol class="breadcrumbs gt-separated dark hidden-l" id="sidebar-nav">
  <li><a href="../../index.html">tiki_sdk_dart</a></li>
  <li><a href="../../node/node-library.html">node</a></li>
  <li><a href="../../node/NodeService-class.html">NodeService</a></li>
  <li class="self-crumb">init method</li>
</ol>


    <h5>NodeService class</h5>
    <ol>

        <li class="section-title"><a href="../../node/NodeService-class.html#constructors">Constructors</a></li>
          <li><a href="../../node/NodeService/NodeService.html">NodeService</a></li>


    <li class="section-title">
      <a href="../../node/NodeService-class.html#instance-properties">Properties</a>
    </li>
    <li class="inherited"><a href="../../node/NodeService/hashCode.html">hashCode</a></li>
    <li><a href="../../node/NodeService/publicKey.html">publicKey</a></li>
    <li class="inherited"><a href="../../node/NodeService/runtimeType.html">runtimeType</a></li>

    <li class="section-title"><a href="../../node/NodeService-class.html#instance-methods">Methods</a></li>
    <li><a href="../../node/NodeService/getBlockById.html">getBlockById</a></li>
    <li><a href="../../node/NodeService/getLastBlock.html">getLastBlock</a></li>
    <li><a href="../../node/NodeService/getTransactionByPath.html">getTransactionByPath</a></li>
    <li><a href="../../node/NodeService/init.html">init</a></li>
    <li class="inherited"><a href="../../node/NodeService/noSuchMethod.html">noSuchMethod</a></li>
    <li class="inherited"><a href="../../node/NodeService/toString.html">toString</a></li>
    <li><a href="../../node/NodeService/write.html">write</a></li>

    <li class="section-title inherited"><a href="../../node/NodeService-class.html#operators">Operators</a></li>
    <li class="inherited"><a href="../../node/NodeService/operator_equals.html">operator ==</a></li>




</ol>

  </div><!--/.sidebar-offcanvas-->

  <div id="dartdoc-sidebar-right" class="sidebar sidebar-offcanvas-right">
  </div><!--/.sidebar-offcanvas-->

</main>

<footer>
  <span class="no-break">
    tiki_sdk_dart
      0.0.3
  </span>

  
</footer>



<script src="../../static-assets/highlight.pack.js?v1"></script>
<script src="../../static-assets/script.js?v1"></script>



</body>

</html>

